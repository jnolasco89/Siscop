<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="content">
        <div class="ui-g ui-fluid">
            <div class="ui-g-12 ui-lg-12">
                <p:layoutUnit position="center">
                    <h3 style="margin-top:0">Mantenimiento de cuentas contables</h3>
                    <h:form id="formTabs">
                        <p:growl id="growl" 
                                 showDetail="true" 
                                 for="msgMttoCuentas"/>
                        <p:tabView id="tabs" 
                                   activeIndex="#{cuentasControllerTree.tabActiva}" 
                                   >
                            <p:tab id="busqueda" title="BÃºsqueda">
                                <h:panelGrid>
                                    <p:menubar>
                                        <p:menuitem>
                                            <p:inputText id="txtCampoBusqueda"/>
                                        </p:menuitem>
                                        <p:menuitem 
                                            value="Buscar" 
                                            icon="ui-icon-search"
                                            />
                                        <p:menuitem 
                                            value="Limpiar" 
                                            icon="ui-icon-refresh" 
                                            update=":formTabs"
                                            />
                                    </p:menubar>
                                </h:panelGrid>
                                <p:tree value="#{cuentasControllerTree.arbolCuentas}" 
                                        var="nodo" 
                                        selectionMode="single"
                                        selection="#{cuentasControllerTree.nodoActual}"
                                        dynamic="true"
                                        >
                                    <p:ajax event="select" 
                                            update=":formTabs" 
                                            listener="#{cuentasControllerTree.cargarCuentaSeleccionada()}"/>
                                    <p:treeNode expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">
                                        <h:outputText value="#{nodo}" />
                                    </p:treeNode>
                                </p:tree>
                            </p:tab>
                            <p:tab id="detalle" title="Detalle">
                                <p:panelGrid>
                                    <p:menubar>
                                        <p:menuitem
                                            value="Guardar"
                                            icon="ui-icon-disk"
                                            />
                                        <p:menuitem
                                            value="Limpiar"
                                            icon="ui-icon-refresh"
                                            update=":formTabs"
                                            />
                                    </p:menubar>
                                </p:panelGrid>
                                <p:panel
                                    style="margin-top: 5px;" 
                                    header="Catalogo">

                                    <div class="ui-g" style="width: 700px;">
                                        <div class="ui-md-6">
                                            <p:outputLabel for="txtSubcuentaDe"
                                                           value="Subcuenta de:"
                                                           />
                                        </div>
                                        <div class="ui-md-6">
                                            <div class="ui-inputgroup">
                                                <p:inputText id="txtSubcuentaDe"
                                                             value="#{cuentasControllerTree.cuentaPadreActual.codigo}"
                                                             />
                                                <p:commandButton icon="ui-icon-search"  
                                                                 styleClass="white-button"
                                                                 onclick="PF('dialogCuentas').show()"/>  
                                            </div>
                                        </div>
                                    </div>
                                    <div class="ui-g" style="width: 700px;">
                                        <div class="ui-md-6">
                                            <p:outputLabel for="txtCodigoCuenta" 
                                                           value="Codigo: "
                                                           />
                                        </div>
                                        <div class="ui-md-6">
                                            <p:inputText id="txtCodigoCuenta" 
                                                         value="#{cuentasControllerTree.cuentaActual.codigo}"
                                                         />
                                        </div>
                                    </div>
                                    <div class="ui-g" style="width: 700px;">
                                        <div class="ui-md-6">
                                            <p:outputLabel for="txtNombreCuenta"
                                                           value="Nombre: "
                                                           />
                                        </div>
                                        <div class="ui-md-6">
                                            <p:inputText id="txtNombreCuenta"
                                                         value="#{cuentasControllerTree.cuentaActual.nombre}"
                                                         />
                                        </div>
                                    </div>
                                    <div class="ui-g" style="width: 700px;">
                                        <div class="ui-md-6">
                                            <p:outputLabel for="txtDescripcionCuenta"
                                                           value="Descripcion: "
                                                           />
                                        </div>
                                        <div class="ui-md-6">
                                            <p:inputTextarea id="txtDescripcionCuenta"
                                                             rows="5" 
                                                             cols="30"
                                                             value="#{cuentasControllerTree.cuentaActual.descripcion}"
                                                             />
                                        </div>
                                    </div>
                                </p:panel>
                            </p:tab>
                        </p:tabView>
                    </h:form>

                    <h:form id="formDialogCuentas">
                        <p:dialog id="dialogCuentas" 
                                  widgetVar="dialogCuentas" 
                                  modal="true" 
                                  header="Cuentas" 
                                  width="500" 
                                  height="300"
                                  resizable="false"

                                  >
                            <p:scrollPanel style="width: 450px;height: 250px;">
                                <p:tree value="#{cuentasControllerTree.arbolCuentas}" 
                                        var="nodo" 
                                        selectionMode="single"
                                        selection="#{cuentasControllerTree.nodoActual}"
                                        dynamic="true"
                                        >
                                    <p:ajax event="select" 
                                            listener="#{cuentasControllerTree.actualizarCuentaPadre()}"
                                            oncomplete="PF('dialogCuentas').hide()"
                                            update="formTabs:tabs:txtSubcuentaDe"
                                            />
                                    <p:treeNode expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">
                                        <h:outputText value="#{nodo}" />
                                    </p:treeNode>
                                </p:tree>
                            </p:scrollPanel>
                            <h:panelGrid columns="3">
                                <p:commandButton 
                                    value="Cancelar" 
                                    type="button"
                                    onclick="PF('dialogCuentas').hide()"

                                    />
                            </h:panelGrid>
                        </p:dialog>
                    </h:form>
                </p:layoutUnit>
            </div>
        </div>
    </ui:define>
</ui:composition>